@tailwind base;
@tailwind components;
@tailwind utilities;

/* Light theme palette: fallback (hex) for all browsers */
:root {
  --background: #f0edec;
  --muted: #e7e0de;
  --accent: #2400e8;
  --card: #ffffff;
  --card-foreground: #0a0a0a;
  --popover: #ffffff;
  --popover-foreground: #0a0a0a;
  --secondary: #f6f6f6;
  --secondary-foreground: #1a1a1a;
  --muted-foreground: #78716c;
  --accent-foreground: #1a1a1a;
  --destructive: #dc2626;
  --destructive-foreground: #ffffff;
  --ring: #a8a29e;
  --table-border: #d9d9d9;
  --sidebar: #fafaf9;
  --sidebar-foreground: #0a0a0a;
  --sidebar-border: #e7e5e4;
}

@supports (color: color(display-p3 0 0 0)) {
  :root {
    --background: color(display-p3 0.941176 0.929412 0.92549);
    --muted: color(display-p3 0.905882 0.878431 0.870588);
    --accent: color(display-p3 0.14 0 0.91);
  }
}

@supports (color: lab(0% 0 0)) {
  :root {
    --card: lab(100% 0 0);
    --card-foreground: lab(2.75381% 0 0);
    --popover: lab(100% 0 0);
    --popover-foreground: lab(2.75381% 0 0);
    --secondary: lab(96.52% -0.0000298023 0.0000119209);
    --secondary-foreground: lab(7.78201% -0.0000149012 0);
    --muted-foreground: lab(48.496% 0 0);
    --accent-foreground: lab(7.78201% -0.0000149012 0);
    --destructive: lab(48.4493% 77.4328 61.5452);
    --destructive-foreground: lab(100% 0 0);
    --ring: lab(66.128% -0.0000298023 0.0000119209);
    --chart-1: lab(57.1026% 64.2584 89.8886);
    --chart-2: lab(55.0223% -41.0774 -3.90277);
    --chart-3: lab(30.372% -13.1853 -18.7887);
    --chart-4: lab(80.1641% 16.6016 99.2089);
    --chart-5: lab(72.7183% 31.8672 97.9407);
    --sidebar: lab(98.26% 0 0);
    --sidebar-foreground: lab(2.75381% 0 0);
    --sidebar-primary: lab(7.78201% -0.0000149012 0);
    --sidebar-primary-foreground: lab(98.26% 0 0);
    --sidebar-accent: lab(96.52% -0.0000298023 0.0000119209);
    --sidebar-accent-foreground: lab(7.78201% -0.0000149012 0);
    --sidebar-border: lab(90.952% 0 0.0000119209);
    --sidebar-ring: lab(66.128% -0.0000298023 0.0000119209);
  }
}

@layer base {
  html {
    @apply font-sans;
    color: var(--card-foreground);
    background-color: var(--background);
  }
  /* Основной текст параграфов: крупнее для доступности (плохое зрение) */
  main p {
    font-size: 1.0625rem; /* 17px на мобильном */
    line-height: 1.625;
  }
  @media (min-width: 768px) {
    main p {
      font-size: 1.125rem; /* 18px на десктопе */
    }
  }
  main {
    width: 100%;
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
    box-sizing: border-box;
  }
  /* Fix preflight for linter: standard appearance + no vertical-align on block */
  button,
  input:where([type="button"]),
  input:where([type="reset"]),
  input:where([type="submit"]) {
    appearance: button;
  }
  [type="search"] {
    appearance: textfield;
  }
  iframe,
  embed,
  object {
    vertical-align: unset;
  }
}

@layer components {
  /* Диагональное зачёркивание (чёрная линия) */
  .strikethrough-diagonal {
    position: relative;
    display: inline-block;
  }
  .strikethrough-diagonal::after {
    content: "";
    position: absolute;
    left: 0;
    top: 50%;
    width: 120%;
    height: 2px;
    background: #0a0a0a;
    transform: rotate(-12deg);
    transform-origin: center;
    pointer-events: none;
  }

  /* Центрирование таблиц: один блок на таблицу, не зависит от flex */
  .table-wrapper {
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    overflow-x: auto;
    box-sizing: border-box;
  }
  .table-wrapper--wide {
    max-width: 1000px;
  }
  .table-wrapper--mobile {
    max-width: 360px;
  }

  .metric-tag.tag-selected,
  .industry-tag.tag-selected {
    border-color: var(--accent);
    background: color-mix(in srgb, var(--accent) 20%, transparent);
  }

  .metric-tag:hover:not(.tag-selected),
  .industry-tag:hover:not(.tag-selected) {
    border-color: var(--accent);
    background: color-mix(in srgb, var(--accent) 18%, var(--background));
  }

  /* Блок «главная кнопка страницы»: кнопка по центру, рукописный текст ниже и правее (как красный прямоугольник); стрелка привязана к тексту и идёт к кнопке */
  .main-button-callout {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.25rem 0;
    margin: 1.5rem 0;
  }
  .main-button-callout__btn {
    --btn-main-bg: #93c47d;
    --btn-main-bg-hover: #82b36b;
    --btn-main-bg-active: #72a05a;
    --btn-main-text: #1a2e0f;
    flex-shrink: 0;
    padding: 0.75rem 1.5rem;
    font-size: 1.0625rem;
    font-weight: 600;
    background: var(--btn-main-bg);
    color: var(--btn-main-text);
    border: 2px solid var(--btn-main-bg);
  }
  .main-button-callout__btn:hover {
    background: var(--btn-main-bg-hover);
    border-color: var(--btn-main-bg-hover);
  }
  .main-button-callout__btn:active {
    background: var(--btn-main-bg-active);
    border-color: var(--btn-main-bg-active);
  }
  .main-button-callout__btn.tag-selected {
    background: var(--btn-main-bg-hover);
    border-color: var(--btn-main-bg-hover);
  }
  .main-button-callout__hint {
    display: flex;
    align-items: center;
    gap: 0.35rem;
    align-self: flex-end; /* ниже и правее кнопки */
  }
  .main-button-callout__arrow {
    width: 44px;
    height: 52px;
    color: var(--card-foreground);
    flex-shrink: 0;
    transform: rotate(-28deg); /* от текста (справа внизу) к кнопке (влево вверх) */
  }
  .main-button-callout__label {
    font-family: "Caveat", cursive;
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--card-foreground);
    white-space: nowrap;
  }
  @media (max-width: 767px) {
    .main-button-callout__hint {
      margin-right: 5%;
    }
  }

  .footer-email-tooltip {
    position: absolute;
    left: 50%;
    bottom: 100%;
    transform: translate(-50%, -6px);
    padding: 6px 10px;
    font-size: 0.75rem;
    line-height: 1.2;
    color: var(--card-foreground);
    background: var(--muted);
    border-radius: 6px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s ease, visibility 0.2s ease;
    pointer-events: none;
  }
  .footer-email-tooltip.is-visible {
    opacity: 1;
    visibility: visible;
  }

  /* Presentation unit: скруглённые карточки и теги, теги в ряд; мобилка 2 в ряд, десктоп 4 в ряд */
  .presentation-unit {
    --sticker-bg: #ffffe0;
    --tag-bg: #f5e6a4;
    --ink: #222222;
  }
  .presentation-unit__intro {
    font-size: 1.0625rem; /* 17px мобильный */
    line-height: 1.625;
    color: var(--ink);
    margin-top: 0.5rem;
    margin-bottom: 1.5rem;
  }
  @media (min-width: 768px) {
    .presentation-unit__intro {
      font-size: 1.125rem; /* 18px десктоп */
    }
  }
  .presentation-unit__grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem 1rem;
  }
  @media (min-width: 768px) {
    .presentation-unit__grid {
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem 1.25rem;
    }
  }
  /* Стикер: на десктопе — по контенту; на мобилке — мин. высота не меньше ширины */
  .presentation-unit__sticker {
    background-color: var(--sticker-bg);
    border-radius: 0;
    border: none;
    padding: 1rem 1.25rem;
    min-height: 10em;
    display: flex;
    flex-direction: column;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  }
  @media (min-width: 768px) {
    .presentation-unit__sticker {
      min-height: 0; /* десктоп: высота только по контенту */
    }
  }
  .presentation-unit__sticker p {
    font-size: 1rem; /* 16px мобильный */
    font-weight: 300;
    line-height: 1.45;
    color: var(--ink);
    margin: 0;
    flex: 1 1 auto;
    min-height: min-content; /* весь текст виден, стикер растёт по высоте */
  }
  @media (min-width: 768px) {
    .presentation-unit__sticker p {
      font-size: 1.0625rem; /* 17px десктоп */
    }
  }
  .presentation-unit__reactions {
    margin-top: auto;
    flex-shrink: 0;
    padding-top: 0.75rem;
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  .presentation-unit__tag {
    display: inline-flex;
    align-items: center;
    padding: 0.35rem 0.65rem;
    font-size: 0.8125rem;
    white-space: nowrap;
    font-weight: 500;
    font-family: inherit;
    color: var(--ink);
    background-color: var(--tag-bg);
    border: none;
    border-radius: 9999px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
    cursor: pointer;
    transition: background-color 0.2s ease;
  }
  .presentation-unit__tag:hover:not(.presentation-unit__tag--voted) {
    background-color: #e8dc80;
  }
  .presentation-unit__tag--voted {
    background-color: #ffd700;
    cursor: default;
    pointer-events: none;
  }

  @media (max-width: 767px) {
    .presentation-unit__sticker {
      min-height: 0; /* по контенту, как на десктопе */
    }
    .presentation-unit__reactions {
      flex-wrap: nowrap;
      gap: 0.35rem;
      margin-top: 0.5rem;
    }
    .presentation-unit__tag {
      padding: 0.25rem 0.4rem;
      font-size: 0.75rem;
    }
  }
}
